<!DOCTYPE html>
<html>
  <head>
    <title>Web Services and Symfony Core Initiative</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <!-- jQuery + history plugin -->
    <script type="text/javascript" src="src/jquery.min.js"></script>
    <script type="text/javascript" src="src/jquery.history.js"></script>

    <!-- Slippy core js file -->
    <script type="text/javascript" src="src/slippy.js"></script>

    <!-- Slippy structural styles -->
    <link type="text/css" rel="stylesheet" href="src/slippy.css"/>

    <!-- Slippy theme (feel free to change it) -->
    <link type="text/css" rel="stylesheet" href="src/slippy-pure.css"/>

    <!-- Specific styles for this presentation -->
    <link type="text/css" rel="stylesheet" href="wscci.css"/>

    <!-- Syntax highlighting core file  -->
    <script type="text/javascript" src="src/highlighter/shCore.js"></script>
    <script type="text/javascript" src="src/highlighter/shBrushPhp.js"></script>

    <!-- Syntax highlighting brushes, this one is only for javascript -->
    <script type="text/javascript" src="src/highlighter/shBrushJScript.js"></script>

    <!-- Syntax highlighting core CSS and a theme -->
    <link type="text/css" rel="stylesheet" href="src/highlighter/shCore.css"/>
    <link type="text/css" rel="stylesheet" href="src/highlighter/shThemeEclipse.css"/>

    <script type="text/javascript">
      $(function() {
          $(".slide").slippy({
            //animLen: 0,
            margin: 0.05
          });
          SyntaxHighlighter.all();
      });
    </script>

  </head>
  <body>

<section class="slide" id="session-title">
  <div class="vcenter">
    <h1>Web Services and <strike>Context</strike> Symfony<br/>Core Initiative</h1>
    <h2>by Larry Garfield</h2>
  </div>
</section>

<section class="slide">
  <h1>@Crell</h1>
  <div style="width: 50%; float: right; ">
    <img style="max-width: 100%; height: auto;" src="images/crell-nerf.jpg" />
  </div>

  <ul>
    <li>Senior Architect, Palantir.net</li>
    <li>Drupal Association Advisor</li>
    <li>Web Services & Context Initiative Owner</li>
    <li>Co-Author,<br /><em>Drupal 7 Module Development</em>,<br />Packt Publishing</li>
    <li>Architectural Gadfly</li>
    <li>Nerf Gunslinger</li>
  </ul>

  <img style="margin-top: 2em;" src="palantir_horiz_trans.png" />
</section>

<!--
<section class="slide">
  <h1>What we do</h1>
  <img style="position: absolute; top: 30px; left: -100px;" src="images/sites/barnard-1.jpg" />
  <img style="position: absolute; top: 60px; left: -70px;" class="incremental" src="images/sites/foreign-affairs-1.jpg" />
  <img style="position: absolute; top: 90px; left: -40px;" class="incremental" src="images/sites/fieldmuseum-1.jpg" />
  <img style="position: absolute; top: 120px; left: -10px;" class="incremental" src="images/sites/opensource-1.jpg" />
  <img style="position: absolute; top: 150px; left: 20px;" class="incremental" src="images/sites/marketplace-1.jpg" />
</section>
-->

<section class="slide">
  <h1>Web Services and Context Core Initiative (WSCCI)</h1>
  <div class="vcenter" style="text-align: center; height: 70%"><img src="images/jack_daniels.jpg" alt="WSCCI" data-credit="http://www.flickr.com/photos/spaterson/4995021726/" /></div>
</section>

<section class="slide">
  <h1>The original plan...</h1>
  <blockquote class="vcenter">The Web Services and Context Core Initiative (WSCCI) aims to
    transform Drupal from a first-class CMS to a first-class REST server with a
    first-class CMS on top of it. To do that, we must give Drupal a unified,
    powerful context system that will support smarter, context- sensitive,
    easily cacheable block-centric layouts and non-page responses using a
    robust unified plugin mechanism.</blockquote>
</section>

<section class="slide">
  <h1 class="vcenter">Huh?</h1>
</section>

<section class="slide">
  <div class="vcenter">
    <h1>REST-First</h1>
    <h1>Development</h1>
  </div>
</section>

<section class="slide">
  <h1>REpresentational State Transfer</h1>
  <ul>
    <li class="incremental">HTTP is your API (verbs, URIs, caching)</li>
    <li class="incremental">Client-server architecture</li>
    <li class="incremental">Very loosely coupled</li>
    <li class="incremental">Stateless</li>
  </ul>
</section>

<section class="slide">
  <h1>Blocks in Drupal 7</h1>
  <div style="text-align: center;"><img src="images/blocks-drupal-7.svg" alt="Blocks in Drupal 7" /></div>
</section>

<section class="slide">
  <h1>Drupal 7 page flow</h1>
  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 1152 733" width="96pc" height="733pt"><metadata xmlns:dc="http://purl.org/dc/elements/1.1/"><dc:date>2012-04-18 20:47Z</dc:date><!-- Produced by OmniGraffle Professional 5.3.6 --></metadata><defs><filter id="Shadow" filterUnits="userSpaceOnUse"><feGaussianBlur in="SourceAlpha" result="blur" stdDeviation="3.488"/><feOffset in="blur" result="offset" dx="0" dy="4"/><feFlood flood-color="black" flood-opacity=".75" result="flood"/><feComposite in="flood" in2="offset" operator="in"/></filter><font-face font-family="Helvetica" font-size="10" units-per-em="1000" underline-position="-75.683594" underline-thickness="49.316406" slope="0" x-height="522.94922" cap-height="717.28516" ascent="770.01953" descent="-229.98047" font-weight="500"><font-face-src><font-face-name name="Helvetica"/></font-face-src></font-face><marker orient="auto" overflow="visible" markerUnits="strokeWidth" id="FilledArrow_Marker" viewBox="-1 -4 10 8" markerWidth="10" markerHeight="8" color="black"><g><path d="M 8 0 L 0 -3 L 0 3 Z" fill="currentColor" stroke="currentColor" stroke-width="1"/></g></marker><font-face font-family="Helvetica" font-size="12" units-per-em="1000" underline-position="-75.683594" underline-thickness="49.316406" slope="0" x-height="522.94922" cap-height="717.28516" ascent="770.01953" descent="-229.98047" font-weight="500"><font-face-src><font-face-name name="Helvetica"/></font-face-src></font-face><font-face font-family="Helvetica" font-size="12" units-per-em="1000" underline-position="-75.683594" underline-thickness="49.316406" slope="0" x-height="532.22656" cap-height="719.72656" ascent="770.01953" descent="-229.98047" font-weight="bold"><font-face-src><font-face-name name="Helvetica-Bold"/></font-face-src></font-face></defs><g stroke="none" stroke-opacity="1" stroke-dasharray="none" fill="none" fill-opacity="1"><title>Drupal 7</title><g><title>Layer 1</title><g><use xl:href="#id72_Graphic" filter="url(#Shadow)"/><use xl:href="#id3_Graphic" filter="url(#Shadow)"/><use xl:href="#id19_Graphic" filter="url(#Shadow)"/><use xl:href="#id76_Graphic" filter="url(#Shadow)"/><use xl:href="#id78_Graphic" filter="url(#Shadow)"/><use xl:href="#id81_Graphic" filter="url(#Shadow)"/><use xl:href="#id84_Graphic" filter="url(#Shadow)"/><use xl:href="#id86_Graphic" filter="url(#Shadow)"/><use xl:href="#id87_Graphic" filter="url(#Shadow)"/><use xl:href="#id88_Graphic" filter="url(#Shadow)"/><use xl:href="#id89_Graphic" filter="url(#Shadow)"/><use xl:href="#id96_Graphic" filter="url(#Shadow)"/><use xl:href="#id99_Graphic" filter="url(#Shadow)"/><use xl:href="#id101_Graphic" filter="url(#Shadow)"/><use xl:href="#id105_Graphic" filter="url(#Shadow)"/><use xl:href="#id106_Graphic" filter="url(#Shadow)"/><use xl:href="#id107_Graphic" filter="url(#Shadow)"/><use xl:href="#id108_Graphic" filter="url(#Shadow)"/><use xl:href="#id11_Graphic" filter="url(#Shadow)"/><use xl:href="#id118_Graphic" filter="url(#Shadow)"/><use xl:href="#id119_Graphic" filter="url(#Shadow)"/></g><g id="id72_Graphic"><path d="M 265.5 45 L 328.5 45 C 335.952 45 342 53.064 342 63 C 342 72.935997 335.952 81 328.5 81 L 265.5 81 C 258.048 81 252 72.935997 252 63 C 252 53.064 258.048 45 265.5 45" fill="#6cf"/><path d="M 265.5 45 L 328.5 45 C 335.952 45 342 53.064 342 63 C 342 72.935997 335.952 81 328.5 81 L 265.5 81 C 258.048 81 252 72.935997 252 63 C 252 53.064 258.048 45 265.5 45" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(266 57)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="12.376953" y="10" textLength="37.246094">Request</tspan></text></g><g id="id3_Graphic"><path d="M 297 180 L 342 198 L 297 216 L 252 198 Z" fill="white"/><path d="M 297 180 L 342 198 L 297 216 L 252 198 Z" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(269.15 191.64)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="7.9663086" y="10" textLength="41.567383">"Routing"</tspan></text></g><line x1="297" y1="81" x2="297" y2="107.1" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><g id="id19_Graphic"><rect x="270" y="306" width="90" height="36" fill="white"/><rect x="270" y="306" width="90" height="36" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(275 318)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="8.869629" y="10" textLength="62.260742">Page callback</tspan></text></g><path d="M 297 216 C 282.0015 236.9979 249.0003 264.0015 252 279 C 254.59631 291.98163 284.16364 295.9765 305.68365 302.65118" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 315 306 C 312.0003 294.00119 308.9997 284.9985 306 270 C 303.53052 257.65259 301.06042 241.23557 298.59073 225.77588" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 315 306 C 335.9979 294.00119 380.9997 284.9985 378 270 C 375.28857 256.44275 333.3562 237.97932 305.38391 221.2638" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><g id="id76_Graphic"><rect x="423" y="261" width="90" height="36" fill="white"/><rect x="423" y="261" width="90" height="36" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(428 273)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="13.8793945" y="10" textLength="52.24121">Drupal-Ajax</tspan></text></g><g id="id78_Graphic"><path d="M 468 162 L 522 184.5 L 468 207 L 414 184.5 Z" fill="white"/><path d="M 468 162 L 522 184.5 L 468 207 L 414 184.5 Z" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(433.57999 172.05)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="17.440918" y="10" textLength="38.896484">Delivery </tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="17.436035" y="22" textLength="36.12793">callback</tspan></text></g><line x1="342" y1="198" x2="404.26956" y2="186.32446" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="468" y1="207" x2="468" y2="251.1" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><g id="id81_Graphic"><rect x="423" y="324" width="90" height="36" fill="white"/><rect x="423" y="324" width="90" height="36" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(428 336)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="1.3769531" y="10" textLength="77.246094">Compile to JSON</tspan></text></g><line x1="468" y1="297" x2="468" y2="314.1" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="468" y1="360" x2="468" y2="395.1" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><g id="id84_Graphic"><rect x="603" y="162" width="90" height="36" fill="white"/><rect x="603" y="162" width="90" height="36" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(608 174)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="26.38916" y="10" textLength="27.22168">HTML</tspan></text></g><line x1="522" y1="184.5" x2="593.11523" y2="180.54915" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><g id="id86_Graphic"><rect x="558" y="279" width="90" height="36" fill="white"/><rect x="558" y="279" width="90" height="36" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(563 291)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="15.532227" y="10" textLength="48.935547">page_build</tspan></text></g><g id="id87_Graphic"><rect x="558" y="378" width="90" height="36" fill="white"/><rect x="558" y="378" width="90" height="36" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(563 390)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="12.48291" y="10" textLength="55.03418">blocks_build</tspan></text></g><g id="id88_Graphic"><rect x="720" y="162" width="90" height="36" fill="white"/><rect x="720" y="162" width="90" height="36" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(725 174)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="16.369629" y="10" textLength="47.260742">page_alter</tspan></text></g><g id="id89_Graphic"><rect x="720" y="261" width="90" height="36" fill="white"/><rect x="720" y="261" width="90" height="36" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(725 273)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="25.546875" y="10" textLength="28.90625">render</tspan></text></g><path d="M 648 198 C 621.0027 215.9982 574.49927 238.50134 567 252 C 560.942 262.90439 580.33374 267.93805 594.3363 274.21396" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 603 315 C 594.0009 329.9985 576 349.50104 576 360 C 576 367.59738 585.4261 370.48337 594.0462 373.7716" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 603 378 C 611.9991 372.0006 630 370.49896 630 360 C 630 351.35065 617.7829 336.59064 608.44666 323.2725" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 603 279 C 611.9991 270.00089 622.50073 265.49866 630 252 C 636.23083 240.78452 640.39215 223.35298 645.06262 207.45396" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="693" y1="180" x2="710.09998" y2="180" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="765" y1="198" x2="765" y2="251.1" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><g id="id96_Graphic"><rect x="126" y="306" width="90" height="36" fill="white"/><rect x="126" y="306" width="90" height="36" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(131 312)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="20.827637" y="10" textLength="38.344727">Services</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="9.423828" y="22" textLength="61.152344">page callback</tspan></text></g><path d="M 293.45276 220.68225 C 258.63864 234.12016 209.40675 246.7818 189 261 C 172.92171 272.2024 174.72966 284.37634 173.28568 296.37253" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><g id="id99_Graphic"><rect x="45" y="387" width="90" height="36" fill="white"/><rect x="45" y="387" width="90" height="36" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(50 399)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="13.5961914" y="10" textLength="52.807617">Load server</tspan></text></g><g id="id101_Graphic"><rect x="252" y="117" width="90" height="36" fill="white"/><rect x="252" y="117" width="90" height="36" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(257 129)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="4.1455078" y="10" textLength="71.708984">Load menu item</tspan></text></g><line x1="297" y1="153" x2="297" y2="170.10001" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 171 342 C 141.00301 347.9994 94.49865 352.50076 81 360 C 71.442856 365.3095 78.426575 372.12408 84.384415 378.84485" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 90 387 C 107.9982 381.0006 130.50134 376.49924 144 369 C 153.88934 363.50592 158.95007 356.4004 164.48795 349.4548" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><g id="id105_Graphic"><rect x="162" y="387" width="90" height="36" fill="white"/><rect x="162" y="387" width="90" height="36" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(167 399)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="5.8203125" y="10" textLength="68.359375">Server callback</tspan></text></g><g id="id106_Graphic"><rect x="162" y="468" width="90" height="36" fill="white"/><rect x="162" y="468" width="90" height="36" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(167 480)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="10.539551" y="10" textLength="58.9209">Server plugin</tspan></text></g><g id="id107_Graphic"><path d="M 130.5 558 L 171 585 L 130.5 612 L 90 585 Z" fill="white"/><path d="M 130.5 558 L 171 585 L 130.5 612 L 90 585 Z" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(105.935 572.46002)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="4.8110352" y="10" textLength="43.90625">Re-parse </tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="13.143555" y="22" textLength="24.46289">paths</tspan></text></g><g id="id108_Graphic"><rect x="207" y="567" width="90" height="36" fill="white"/><rect x="207" y="567" width="90" height="36" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(212 579)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="18.325195" y="10" textLength="43.34961">Controller</tspan></text></g><path d="M 207 423 C 198.0009 431.99911 180 442.50076 180 450 C 180 455.46918 189.57422 459.34387 198.24844 463.368" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 207 468 C 218.9988 462.0006 243 457.49924 243 450 C 243 443.98303 227.54909 436.03326 215.24361 428.47748" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 203.11829 511.52393 C 177.41476 518.01532 138.10184 523.25476 126 531 C 117.779266 536.26135 122.11157 542.6811 126.20599 549.07843" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 130.5 558 C 149.99805 549.0009 176.25128 539.9991 189 531 C 197.57053 524.9502 200.04128 518.89923 202.56299 512.84863" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 207 504 C 209.9997 515.99878 208.50075 529.50104 216 540 C 221.89981 548.2597 233.37163 554.6645 243.83914 561.4027" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 252 567 C 254.9997 555.00122 268.49924 541.49896 261 531 C 254.66371 522.1292 233.33334 515.39795 216.01375 508.09543" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="171" y1="342" x2="200.81552" y2="379.2694" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="252" y1="405" x2="287.1" y2="405" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><g id="id11_Graphic"><path d="M 729 351 L 747 333 L 783 333 L 801 351 L 783 369 L 747 369 Z" fill="#f66"/><path d="M 729 351 L 747 333 L 783 333 L 801 351 L 783 369 L 747 369 Z" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(752 344)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".66308594" y="11" textLength="24.673828">Print</tspan></text></g><line x1="765" y1="297" x2="765" y2="323.1" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><g id="id118_Graphic"><path d="M 432 423 L 450 405 L 486 405 L 504 423 L 486 441 L 450 441 Z" fill="#f66"/><path d="M 432 423 L 450 405 L 486 405 L 504 423 L 486 441 L 450 441 Z" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(455 416)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".66308594" y="11" textLength="24.673828">Print</tspan></text></g><g id="id119_Graphic"><path d="M 297 405 L 315 387 L 351 387 L 369 405 L 351 423 L 315 423 Z" fill="#f66"/><path d="M 297 405 L 315 387 L 351 387 L 369 405 L 351 423 L 315 423 Z" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(320 398)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".66308594" y="11" textLength="24.673828">Print</tspan></text></g><text transform="translate(234 317)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="bold" x="0" y="11" textLength="18">OR</tspan></text><rect x="280.49942" y="248.443" width="50" height="38" fill="white"/><text transform="translate(285.49942 253.443)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".32128906" y="11" textLength="39.357422">Render</tspan><tspan font-family="Helvetica" font-size="12" font-weight="500" x="6.330078" y="25" textLength="27.339844">array</tspan></text><rect x="332.16446" y="237.84576" width="69" height="38" fill="white"/><text transform="translate(337.16446 242.84576)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="17.828125" y="11" textLength="23.34375">Ajax</tspan><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".15625" y="25" textLength="58.6875">commands</tspan></text><rect x="418.5" y="217.5" width="99" height="24" fill="white"/><text transform="translate(423.5 222.5)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="1.8173828" y="11" textLength="85.365234">Ajax commands</tspan></text><rect x="531.39233" y="163.58931" width="50" height="38" fill="white"/><text transform="translate(536.39233 168.58931)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".32128906" y="11" textLength="39.357422">Render</tspan><tspan font-family="Helvetica" font-size="12" font-weight="500" x="6.330078" y="25" textLength="27.339844">array</tspan></text><rect x="724.5" y="214" width="81" height="24" fill="white"/><text transform="translate(729.5 219)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".484375" y="11" textLength="70.03125">Render array</tspan></text></g></g></svg>
</section>

<section class="slide">
  <h1>Blocks/Requests in Drupal 8</h1>
  <div style="text-align: center;"><img src="images/blocks-drupal-8.svg" alt="Blocks in Drupal 8" /></div>
</section>

<section class="slide">
  <div class="vcenter" style="text-align: center;"><img src="images/symfony2-logo.png" alt="Symfony2" /></div>
</section>

<section class="slide">
  <h1>Where did Symfony2 come from?</h1>
  <ul>
    <li class="incremental">Just wanted a request/response library</li>
    <li class="incremental">Symfony2 vs. Zend: Symfony2</li>
    <li class="incremental">Oh, wait, they did this already...</li>
  </ul>
</section>

<section class="slide">
  <h1>What is Symfony2?</h1>
  <div class="vcenter">
    <div class="incremental" style="float: left">
      <h2>Symfony2 Components</h2>
      <ul>
        <li>Reusable set of stand-alone libraries</li>
        <li>Solid Object-Oriented toolset</li>
      </ul>
    </div>
    <div class="incremental" style="float: left">
      <h2>Symfony2 Framework</h2>
      <ul>
        <li>Application framework</li>
        <li>Build on top of the Components</li>
      </ul>
    </div>
  </div>
</section>

<section class="slide">
  <h1>So what are we using?</h1>
  <img src="images/symfony2-components.png" />
</section>

<section class="slide">
  <div class="vcenter" style="text-align: center;"><img src="images/drufony.png" alt="Symfony2 + Drupal 8 = Drufony" /></div>
</section>

<section class="slide">
  <h1 class="vcenter">HttpFoundation</h1>
</section>

<section class="slide">
  <h1>HttpFoundation</h1>
  <div class="incremental" style="float: left">
    <h2>Request</h2>
    <ul>
      <li>HTTP command</li>
      <li>Self-contained action</li>
      <li>Lots of "headers" for metadata</li>
    </ul>
    <pre class="incremental" style="margin-top: 3em; color: green;">
    GET /foo/bar.html HTTP/1.1
    Host: example.com
    Accept: text/html
    ...
    </pre>
  </div>
  <div class="incremental" style="float: left">
    <h2>Response</h2>
    <ul>
      <li>HTTP result</li>
      <li>Self-contained payload</li>
      <li>Lots of "headers for metadata</li>
    </ul>
    <pre class="incremental" style="margin-top: 3em; color: green;">
    HTTP/1.1 200 OK
    Date: Fri, 18 May 2012 08:08:08 GMT
    Content-Length: 14
    Content-Type: text/html

    Hello World!
    </pre>
  </div>

  <div style="clear: all">
  </div>
</section>

<section class="slide">
  <h1>PHP's request API</h1>
  <pre class="brush: php">
  session_start();

  $name = $_GET['name'];

  echo $_SESSION['name'];

  $method = $_SERVER['REQUEST_METHOD'];

  $client_ip = $_SERVER['REMOTE_ADDR'];
  </pre>

  <div class="incremental">
    <pre class="brush: php">
    if ($trust_proxy) {
      if (isset($_SERVER['HTTP_CLIENT_IP'])) {
        return $_SERVER['HTTP_CLIENT_IP'];
      }
      if (isset($_SERVER['HTTP_X_FORWARDED_FOR'])) {
        $ips = explode(',', $_SERVER['HTTP_X_FORWARDED_FOR'], 2);
        return isset($ips[0]) ? trim($ips[0]) : '';
      }
    }
    return $_SERVER['REMOTE_ADDR'];
    </pre>
  </div>
</section>

<section class="slide">
  <h1>PHP's request API</h1>
  <ul>
    <li class="incremental">Singletons</li>
    <li class="incremental">Not testable</li>
    <li class="incremental">Minimal abstraction</li>
  </ul>
</section>

<section class="slide">
  <h1>Symfony2's request API</h1>
  <div class="vcenter">
    <pre class="brush: php">
      use Symfony\Component\HttpFoundation\Request;

      $request = Request::createFromGlobals();

      $request = Request::create('/hello.html', 'GET');
      $request->overrideGlobals();

      $request->query->get('name', 'Default');
      $request->getSession()->get('name');
      $request->getPathInfo();
      $request->getClientIp();
      Request::trustProxyData();
    </pre>
  </div>
</section>

<section class="slide">
  <h1>PHP's response API</h1>
  <div class="vcenter">
    <pre class="brush: php">
    header('HTTP/1.0 404 Not Found');
    header('Content-Type: text/html; charset=UTF-8');

    setcookie('name', $name);
    $_SESSION['name'] = 'Larry';

    echo 'Hello ' . $name;
    </pre>
   </div>
</section>

<section class="slide">
  <h1>PHP's response API</h1>
  <ul>
    <li class="incremental">Singletons</li>
    <li class="incremental">Not testable</li>
    <li class="incremental">No CLI support</li>
    <li class="incremental">Order issues (header vs. print)</li>
    <li class="incremental">Minimal abstraction</li>
  </ul>
</section>

<section class="slide">
  <h1>Symfony2's response API</h1>
  <pre class="brush: php">
  use Symfony\Component\HttpFoundation\Response;

  $response = new Response('No page. :-(', 404, array(
    'Content-Type' => 'text/plain',
  ));

  $response = new Response();
  $response->setContent('Hello World');
  $response->send();
  </pre>
  <div class="incremental">
    <pre class="brush: php">
    use Symfony\Component\HttpFoundation\StreamedResponse;

    $response = new StreamedResponse(function () {
      echo 'foo';
      flush();
      echo 'bar';
    });

    // Later
    $response->send();

    </pre>
  </div>
</section>

<section class="slide">
  <h1 class="vcenter">EventDispatcher</h1>
</section>

<section class="slide">
  <h1>EventDispatcher</h1>
  <p>Like hooks, but</p>
  <ul>
    <li class="incremental">Object-oriented</li>
    <li class="incremental">Testable</li>
    <li class="incremental">More self-evident</li>
    <li class="incremental">Groupable</li>
  </ul>
</section>

<section class="slide">
  <h1>EventDispatcher</h1>
  <pre class="brush: php">
  use Symfony\Component\EventDispatcher\EventDispatcher;

  $dispatcher = new EventDispatcher();

  // Somewhere...
  $callable = function (Event $event) {
    // do something
  };
  $dispatcher->addListener('event_name', $callable);

  // Equivalent of module_invoke_all().
  $dispatcher->dispatch('event_name', new Event());
  </pre>
  <div class="incremental">
    <pre class="brush: php">
    class PlusOneSubscribe implements EventSubscriberInterface {

      public function onMyEvent(Event $event) {
        // Do stuff
      }

      static function getSubscribedEvents() {
        $events['event_name'][] = array('onMyEvent');
        return $events;
      }
    }

    $dispatcher->addSubscriber(new PlusOneSubscribe());
    </pre>
   </div>
</section>

<section class="slide">
  <div class="vcenter">
    <h1>HttpKernel</h1>
    <h1 style="margin-top: 2em;">Routing</h1>
  </div>
</section>

<section class="slide">
  <h1>HttpKernel</h1>
  <ul>
    <li class="incremental">Ties everything together</li>
    <li class="incremental">Map a Request to a Response</li>
  </ul>
</section>

<section class="slide">
  <h1>HttpKernelInterface</h1>
  <div class="vcenter">
    <pre class="brush: php">
    namespace Symfony\Component\HttpKernel;

    interface HttpKernelInterface {
      /**
       * Handles a request.
       *
       * @param Request $request
       *   A request instance
       * @return $response
       *   A Response instance
       */
      function handle(Request $request, $type = self::MASTER_REQUEST, $catch = true);
    }
    </pre>
   </div>
</section>

<section class="slide">
  <h1>HttpKernel</h1>
    <div class="vcenter" style="text-align: center;"><img src="images/kernel-flow.png" alt="Kernel workflow" data-credit="http://www.flickr.com/photos/spaterson/4995021726/" /></div>
</section>

<section class="slide">
  <h1>index.php (before the Container)</h1>
  <div class="vcenter">
    <pre class="brush: php">
    use Drupal\Core\DrupalKernel;
    use Symfony\Component\HttpFoundation\Request;
    use Symfony\Component\EventDispatcher\EventDispatcher;
    use Symfony\Component\HttpKernel\Controller\ControllerResolver;

    // Create a request object from the HTTPFoundation.
    $request = Request::createFromGlobals();

    $dispatcher = new EventDispatcher();
    $resolver = new ControllerResolver();

    $kernel = new DrupalKernel($dispatcher, $resolver);
    $response = $kernel->handle($request);

    $response->prepare($request);
    $response->send();
    $kernel->terminate($request, $response);
    </pre>
   </div>
</section>

<section class="slide">
  <h1>Drupal 8 page flow (planned)</h1>
  <div style="text-align: center;">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 576 733" width="48pc" height="733pt"><metadata xmlns:dc="http://purl.org/dc/elements/1.1/"><dc:date>2012-04-18 20:47Z</dc:date><!-- Produced by OmniGraffle Professional 5.3.6 --></metadata><defs><filter id="Shadow" filterUnits="userSpaceOnUse"><feGaussianBlur in="SourceAlpha" result="blur" stdDeviation="3.488"/><feOffset in="blur" result="offset" dx="0" dy="4"/><feFlood flood-color="black" flood-opacity=".75" result="flood"/><feComposite in="flood" in2="offset" operator="in"/></filter><font-face font-family="Helvetica" font-size="12" units-per-em="1000" underline-position="-75.683594" underline-thickness="49.316406" slope="0" x-height="522.94922" cap-height="717.28516" ascent="770.01953" descent="-229.98047" font-weight="500"><font-face-src><font-face-name name="Helvetica"/></font-face-src></font-face><font-face font-family="Helvetica" font-size="10" units-per-em="1000" underline-position="-75.683594" underline-thickness="49.316406" slope="0" x-height="522.94922" cap-height="717.28516" ascent="770.01953" descent="-229.98047" font-weight="500"><font-face-src><font-face-name name="Helvetica"/></font-face-src></font-face><marker orient="auto" overflow="visible" markerUnits="strokeWidth" id="FilledArrow_Marker" viewBox="-1 -4 10 8" markerWidth="10" markerHeight="8" color="black"><g><path d="M 8 0 L 0 -3 L 0 3 Z" fill="currentColor" stroke="currentColor" stroke-width="1"/></g></marker><font-face font-family="Helvetica" font-size="12" units-per-em="1000" underline-position="-75.683594" underline-thickness="49.316406" slope="0" x-height="532.22656" cap-height="719.72656" ascent="770.01953" descent="-229.98047" font-weight="bold"><font-face-src><font-face-name name="Helvetica-Bold"/></font-face-src></font-face></defs><g stroke="none" stroke-opacity="1" stroke-dasharray="none" fill="none" fill-opacity="1"><title>Drupal 8/Symfony</title><g><title>Layer 1</title><g><use xl:href="#id86_Graphic" filter="url(#Shadow)"/><use xl:href="#id1_Graphic" filter="url(#Shadow)"/><use xl:href="#id19_Graphic" filter="url(#Shadow)"/><use xl:href="#id3_Graphic" filter="url(#Shadow)"/><use xl:href="#id28_Graphic" filter="url(#Shadow)"/><use xl:href="#id71_Graphic" filter="url(#Shadow)"/><use xl:href="#id72_Graphic" filter="url(#Shadow)"/><use xl:href="#id74_Graphic" filter="url(#Shadow)"/><use xl:href="#id75_Graphic" filter="url(#Shadow)"/><use xl:href="#id76_Graphic" filter="url(#Shadow)"/><use xl:href="#id79_Graphic" filter="url(#Shadow)"/><use xl:href="#id87_Graphic" filter="url(#Shadow)"/></g><g id="id86_Graphic"><rect x="27" y="405.00003" width="324" height="223.35178" fill="white" fill-opacity="0"/><rect x="27" y="405.00003" width="324" height="223.35178" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(32 410)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="0" y="11" textLength="70.04297">Sub-Request</tspan></text></g><g id="id1_Graphic"><rect x="288" y="252" width="63" height="27" fill="white"/><rect x="288" y="252" width="63" height="27" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(293 258.5)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="2.1542969" y="11" textLength="48.691406">Listeners</tspan></text></g><g id="id19_Graphic"><rect x="198" y="243" width="90" height="36" fill="white"/><rect x="198" y="243" width="90" height="36" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(203 255)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="25.546875" y="10" textLength="28.90625">Kernel</tspan></text></g><g id="id3_Graphic"><path d="M 99 243 L 144 261 L 99 279 L 54 261 Z" fill="white"/><path d="M 99 243 L 144 261 L 99 279 L 54 261 Z" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(71.15 254.64001)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="13.742676" y="10" textLength="30.014648">Router</tspan></text></g><path d="M 198 261 C 189.0009 246.0015 187.49835 218.9997 171 216 C 156.5285 213.36882 130.511765 229.20322 108.14256 239.20671" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 99 279 C 122.9976 284.99939 154.50165 299.9997 171 297 C 184.00212 294.63599 187.69064 281.09143 193.0748 269.58405" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><g id="id28_Graphic"><ellipse cx="211.5" cy="369" rx="40.500076" ry="18.000046" fill="white"/><ellipse cx="211.5" cy="369" rx="40.500076" ry="18.000046" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(184.10001 362)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="1.3902359" y="11" textLength="52.01953">Controller</tspan></text></g><path d="M 243 279 C 228.0015 290.99881 204.01505 303.06381 198 315 C 193.5404 323.84955 198.9574 332.63226 203.26697 341.42178" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 231.56404 352.94876 C 247.37445 340.30045 277.0942 327.32355 279 315 C 280.56482 304.88123 263.37842 295.19788 250.53656 285.4147" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><g id="id71_Graphic"><path d="M 292.5 126 L 355.5 126 C 362.952 126 369 134.063995 369 144 C 369 153.936005 362.952 162 355.5 162 L 292.5 162 C 285.048 162 279 153.936005 279 144 C 279 134.063995 285.048 126 292.5 126" fill="#f66"/><path d="M 292.5 126 L 355.5 126 C 362.952 126 369 134.063995 369 144 C 369 153.936005 362.952 162 355.5 162 L 292.5 162 C 285.048 162 279 153.936005 279 144 C 279 134.063995 285.048 126 292.5 126" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(293 138)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="8.4853516" y="10" textLength="45.029297">Response</tspan></text></g><g id="id72_Graphic"><path d="M 157.5 126 L 220.5 126 C 227.952 126 234 134.063995 234 144 C 234 153.936005 227.952 162 220.5 162 L 157.5 162 C 150.048 162 144 153.936005 144 144 C 144 134.063995 150.048 126 157.5 126" fill="#6cf"/><path d="M 157.5 126 L 220.5 126 C 227.952 126 234 134.063995 234 144 C 234 153.936005 227.952 162 220.5 162 L 157.5 162 C 150.048 162 144 153.936005 144 144 C 144 134.063995 150.048 126 157.5 126" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(158 138)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="12.376953" y="10" textLength="37.246094">Request</tspan></text></g><line x1="243" y1="243" x2="316.99963" y2="169.00037" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="189" y1="162" x2="237.50847" y2="234.7627" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><g id="id74_Graphic"><rect x="279" y="468" width="63" height="27" fill="white"/><rect x="279" y="468" width="63" height="27" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(284 474.5)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="2.1542969" y="11" textLength="48.691406">Listeners</tspan></text></g><g id="id75_Graphic"><rect x="189" y="459" width="90" height="36" fill="white"/><rect x="189" y="459" width="90" height="36" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(194 471)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="25.546875" y="10" textLength="28.90625">Kernel</tspan></text></g><g id="id76_Graphic"><path d="M 90 459 L 135 477 L 90 495 L 45 477 Z" fill="white"/><path d="M 90 459 L 135 477 L 90 495 L 45 477 Z" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(62.15 470.64001)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="13.742676" y="10" textLength="30.014648">Router</tspan></text></g><path d="M 189 477 C 180.0009 462.0015 178.49835 434.9997 162 432 C 147.52849 429.36884 121.51177 445.20322 99.14256 455.20667" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 90 495 C 113.9976 500.9994 145.50165 515.9997 162 513 C 175.00212 510.636 178.69064 497.0914 184.0748 485.58401" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><g id="id79_Graphic"><ellipse cx="238.5" cy="585" rx="40.500076" ry="18.000046" fill="white"/><ellipse cx="238.5" cy="585" rx="40.500076" ry="18.000046" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(211.1 578)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="1.3902359" y="11" textLength="52.01953">Controller</tspan></text></g><path d="M 234 495 C 219.0015 506.9988 190.85355 518.84167 189 531 C 187.48422 540.94275 203.55217 551.10144 215.63367 561.21014" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 248.91751 567.14142 C 255.9443 555.09546 272.486 543.02234 270 531 C 267.9697 521.18134 253.24695 511.39175 241.3816 501.59656" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 213.34799 387.4799 C 214.2319 396.31903 212.55835 402.08118 216 414 C 218.76408 423.5723 224.82886 437.12036 230.21754 449.85345" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 234 459 C 245.9988 444.0015 270.30621 426.34973 270 414 C 269.75238 404.0141 253.41173 397.49 240.49811 390.22961" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><g id="id87_Graphic"><ellipse cx="364.5" cy="369" rx="40.500076" ry="18.000046" fill="white"/><ellipse cx="364.5" cy="369" rx="40.500076" ry="18.000046" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(337.1 362)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="1.3902359" y="11" textLength="52.01953">Controller</tspan></text></g><path d="M 243 279 C 262.909 293.9985 286.06808 311.61197 302.73294 324 C 315.9444 333.8209 325.08057 340.36234 334.98666 347.5234" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 362.95947 350.51398 C 361.97308 338.67715 379.99124 326.91782 360 315 C 341.5745 304.0156 290.85004 292.89053 252.4851 281.82071" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(279 360)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="bold" x="0" y="11" textLength="18">OR</tspan></text><rect x="223.57712" y="324.70642" width="65" height="24" fill="white"/><text transform="translate(228.57712 329.70642)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".48242188" y="11" textLength="54.035156">Response</tspan></text><rect x="232.745" y="413.4928" width="65" height="24" fill="white"/><text transform="translate(237.745 418.4928)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".48242188" y="11" textLength="54.035156">Response</tspan></text><rect x="237.73294" y="522.1892" width="65" height="24" fill="white"/><text transform="translate(242.73294 527.1892)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".48242188" y="11" textLength="54.035156">Response</tspan></text><rect x="318.116" y="298.43335" width="65" height="24" fill="white"/><text transform="translate(323.116 303.43335)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".48242188" y="11" textLength="54.035156">Response</tspan></text><rect x="127.73366" y="205.97258" width="55" height="24" fill="white"/><text transform="translate(132.73366 210.97258)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".15234375" y="11" textLength="44.695312">Request</tspan></text></g></g></svg>
  </div>
<!--  <div style="text-align: center;"><img src="images/request-flow-drupal-8.svg" alt="Request flow in Drupal 8" /></div>-->
</section>

<section class="slide">
  <h1 class="vcenter">So what changes?</h1>
</section>

<section class="slide">
  <h1>Controllers</h1>
  <ul>
    <li class="incremental">"Thing the kernel asks for a response."</li>
    <li class="incremental">Page callback, only better!</li>
    <li class="incremental">Block, only better!</li>
    <li class="incremental">Controller == Page callback == Block =></li>
    <li class="incremental"><em>Every block is (can be) a subreqest</em></li>
    <li class="incremental">Every subrequest is HTTP cacheable</li>
  </ul>
</section>

<section class="slide">
  <h1>Routing</h1>
  <div>Route based on more than path: Method, content type, etc.</div>

  <table class="visible" style="width: 100%; border: 1px solid black;">
    <thead>
      <tr><th>Method</th> <th>Path</th> <th>Accept header</th> <th>Result</th></tr>
    </thead>
    <tbody>
      <tr class="incremental"><td>GET</td> <td>node/1</td> <td>text/html</td> <td class="incremental"><strong>Node view page</strong></td></tr>
      <tr class="incremental"><td>GET</td> <td>node/1</td> <td>application/json</td> <td class="incremental"><strong>JSON-LD record</strong></td></tr>
      <tr class="incremental"><td>POST</td> <td>system/form/node_edit</td> <td>text/html</td> <td class="incremental"><strong>Submit a node form and redirect</strong></td></tr>
      <tr class="incremental"><td>PUT</td> <td>node/1</td> <td>application/json</td> <td class="incremental"><strong>Overwrite the node exactly</strong></td></tr>
    </tbody>
  </table>
</section>

<section class="slide">
  <h1>Routing</h1>
  <p>New routing syntax (farewell <code>hook_menu()</code>?)</p>
  <div class="alert" style="text-align: center; margin-top: 1em; font-size: 1.2em;"><em>Warning, early untested prototype</em></div>

  <pre class="brush: php">
    function example_route_info() {
      $routes['node_page'] = array(
        'route' => new Route('/node/{node}', array(
          '_controller' => 'NodeController:show',
        )),
        // This gets objectified later...
        'access' => array(
          'callback' => array('function' => 'node_access'),
          'arguments' => array('view'),
        ),
      );
      return $routes;
    }

    class NodeController {
      public function show(Node $node) {
        // ...
        return new Response($content);
      }
    }
  </pre>
</section>

<section class="slide">
  <h1>Routing (fancy)</h1>

  <pre class="brush: php">
    function example_route_info() {
      $routes['blog_list'] = array(
        'route' => new Route('/blog/{page}', array(
          '_controller' => 'BlogController:show',
          'page' => 1, // Default value
        ), array(
          'page' => '\d+',
          '_method' => 'GET',
        )),
        // This gets objectified later...
        'access' => array(
          'callback' => array('function' => 'node_access'),
          'arguments' => array('view'),
        ),
      );
      return $routes;
    }

    class BlogController {
      public function show(Request $request, $page) {
        // Link to router items, not random URLs.
        $link = $this->generator->generate('node_page', array('node' => 5));
        // ...
        return new Response($content);
      }
    }
  </pre>
</section>

<section class="slide">
  <div class="vcenter">
    <h2 style="margin-top: 4em;">Now we're talking REST...</h2>
    <h2 class="incremental" style="margin-top: 4em;">"Pages" are a special case of REST</h2>
  </div>
</section>

<section class="slide">
  <div class="vcenter">
    <h2 style="margin-top: 4em;">Needs Review...</h2>
    <h2 style="margin-top: 4em;"><a href="http://drupal.org/node/1606794">http://drupal.org/node/1606794</a></h2>
  </div>
</section>

<section class="slide">
  <h1>Side-benefits</h1>
  <ul>
    <li class="incremental">Cleaner, more modular code</li>
    <li class="incremental">More object-oriented (more testable, if we do it right)</li>
    <li class="incremental">Dependency Injection Container(!)</li>
    <li class="incremental">Lots of knock-on refactoring to clean up old crap</li>
  </ul>
  <h3 class="incremental vcenter" style="text-align: center;">(Please help clean up old crap!)</h3>
</section>

<section class="slide">
  <div  class="vcenter">
    <blockquote>A large part of WSCCI is simply paying down years of<br/>technical debt.</blockquote>
    <blockquote>That means we can do other cool things.</blockquote>
  </div>
</section>

<section class="slide">
  <h1>Things like... SCOTCH</h1>
  <ul>
    <li class="incremental">Blocks and Layout Initiative</li>
    <li class="incremental">"Panels in Core", without the bad parts</li>
    <li class="incremental">Talk to Kris Vanderwater (EclipseGc) and Bojhan</li>
  </ul>
</section>

<section class="slide">
  <h1>Things like... Deployment</h1>
  <ul>
    <li class="incremental">Entity API cleanup</li>
    <li class="incremental">JSON-LD as standard export format</li>
    <li class="incremental">=> Reading/writing nodes via standard web services becomes easy*!</li>
    <li class="incremental"><a href="http://groups.drupal.org/node/237443">Vision</a> - <a href="http://drupal.org/node/1540656">Roadmap</a></li>
    <li class="incremental">Talk to fago or Dixon</li>
  </ul>

  <h3 class="incremental vcenter" style="text-align: center;">[*] The management will not be held responsible if "easy" is insufficiently easy for your client.</h3>
</section>

<section class="slide">
  <h1>Collaboration</h1>
  <ul>
    <li class="incremental">Symfony2: MIT License</li>
    <li class="incremental">Drupal: GPL License</li>
    <li class="incremental">Code only flows one way. :-(</li>
  </ul>
</section>

<section class="slide">
  <h1>Work upstream</h1>
  <ul>
    <li class="incremental">Symfony2 "flash messages": Simple session message persistence</li>
    <li class="incremental"><code>drupal_set_message()</code></li>
    <li class="incremental">Make less code in the world!</li>
    <li class="incremental">Drupalers designed needs for improved API</li>
    <li class="incremental">Drak (of Zikula CMS) implemented it</li>
    <li class="incremental">All Symfony2-based projects benefit!</li>
     <li class="incremental"><a href="http://drupal.org/node/335411">Drupal issue</a>: Reviews desperately needed!</li>
  </ul>
</section>

<section class="slide">
  <h1>Streaming</h1>
  <ul>
    <li class="incremental"><a href="http://www.garfieldtech.com/blog/readfile-memory">http://www.garfieldtech.com/blog/readfile-memory</a></li>
    <li class="incremental"><a href="http://drupal.org/node/1561362">http://drupal.org/node/1561362</a></li>
    <li class="incremental">Make new file stream response object in Symfony/HttpFoundation</li>
    <li class="incremental">We get to use it all over</li>
    <li class="incremental">Everyone else uses it all over</li>
    <li class="incremental"><a href="https://github.com/symfony/symfony/pull/4546">Symfony pull request</a></li>
    <li class="incremental">Make less code in the world!</li>
    <li class="incremental">Volunteers?</li>
  </ul>
</section>

<section class="slide">
  <h1>Odds and ends</h1>
  <ul>
    <li><a href="https://github.com/symfony/symfony/pull/3954"><code>Response::prepare()</code> chaining</a></li>
    <li><a href="https://github.com/symfony/symfony/pull/4017">Improve FlattenException</a></li>
    <li><a href="https://github.com/symfony/symfony/pull/4510">UTF-8 encoding weirdness in JSON</a></li>
    <li><a href="https://github.com/symfony/symfony/pull/4363">Allow Router matching on a full Request</a></li>
    <li><a href="https://github.com/symfony/symfony/pull/4642">Make RouteCollection Countable</a></li>
    <li><a href="https://github.com/symfony/symfony/pull/4755">Improve Route serialization</a></li>

    <li class="incremental" style="margin-top: 2em;">Plenty more to come...</li>
  </ul>
</section>


<section class="slide">
  <h1 class="vcenter">On the Drupal side...</h1>
</section>

<section class="slide">
  <h1>Bundles</h1>
  <ul>
    <li class="incremental">Symfony equivalent of "modules" (sorta kinda)</li>
    <li class="incremental">Registers services and events in the Injection Container</li>
    <li class="incremental">Lets modules be useful in a Symfony-based world!</li>
    <li class="incremental"><a href="http://drupal.org/node/1599108">Drupal issue</a></li>
    <li class="incremental">Volunteers? Talk to me or Kat Bailey</li>
  </ul>
</section>

<section class="slide">
  <h1>Other issues</h1>
  <ul>
    <li class="incremental">Write secure PHP code to disk: <a href="http://drupal.org/node/1675260">Issue</a></li>
    <li class="incremental">Replace drupal_http_request() with Guzzle: <a href="http://drupal.org/node/1447736">Issue</a></li>
    <li class="incremental">Clean up Drupal.ajax system: <a href="http://drupal.org/node/1533366">Issue</a></li>
    <li class="incremental">Replace drupal_goto() with a Response object: <a href="http://drupal.org/node/1668866">Issue</a></li>
    <li class="incremental">Rewrite the installer to not suck: <a href="http://drupal.org/node/1530756">Issue</a></li>

    <li class="incremental" style="margin-top: 2em;">And many more...  Just look for the <a href="http://drupal.org/project/issues/search/drupal?status[]=Open&issue_tags=WSCCI">WSCCI</a> tag.</li>
  </ul>
</section>

<section class="slide">
  <h1>Excited yet?</h1>

  <h3 class="vcenter incremental" style="text-align: center;">I hope so, because we need your help...</h3>
</section>

<section class="slide">
  <div class="vcenter">
    <h1>Questions?</h1>
    <h2 style="text-align: center; margin-top: 3em;"><a href="http://groups.drupal.org/wscci">http://groups.drupal.org/wscci</a></h2>
  </div>
</section>


<div class="footer">
  <span class="right"><a href="irc://freenode/#drupal-wscci">#drupal-wscci IRC</a></span>
  <span style="text-align: center">Midwest Developers Summit 2012</span>
  <span class="left"><a href="http://groups.drupal.org/wscci">groups.drupal.org/wscci</a></span>
  <hr class="defloat" />
</div>

  </body>
</html>
